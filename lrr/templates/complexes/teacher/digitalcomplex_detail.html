{% extends "base.html" %}
{% load static %}
{% load user_tags %}
{% block content %}
  <nav aria-label="breadcrumb">
    <ol class="breadcrumb px-3 pb-0">
      <li class="breadcrumb-item"><a href="/"><i class="fas fa-university fa-lg"></i></a></li>
      <li class="breadcrumb-item"><a href="{% url 'complexes:complexes_DigitalComplex_list' %}">Список ЭУМК</a></li>
      <li class="breadcrumb-item active" aria-current="page">Паспорт ЭУМК</li>
    </ol>
  </nav>
  <header class="pb-4 px-2">
    {% if request.user|has_owner_complex:object %}
      {% if request.user.is_superuser %}
        <a class="btn btn-primary float-right" href="{{ object.get_update_url }}"><i
                class="pen icon"></i>Редактировать</a>
      {% endif %}
    {% endif %}
    <h2>Электронный учебно-методический комплекс по дисциплине(ам)
      {% for obj in object.subjects.all %}{{ obj }}{% endfor %}</h2>
    <p>Паспорт электронного учебно-методического комплекса</p>
  </header>
  <div class="row p-2">
    <div class="col-12 col-md-6 col-lg-7 col-xl-8 p-2">
      <div class="card h-100 border-secondary shadow-2">
        <div class="card-body">
          <h6 class="card-subtitle mb-2 text-muted">Дисциплины</h6>
          {% for obj in object.subjects.all %}
            <p>{{ obj }}</p>
            <hr>
          {% endfor %}
          <h6 class="card-subtitle mb-2 text-muted">Направления подготовки/Образовательная программа:</h6>
          {% for obj in object.directions.all %}
            <p>{{ obj }}</p>
            <hr>
          {% endfor %}
          <h6 class="card-subtitle mb-2 text-muted">Формат использования:</h6>
          <p>{{ object.get_format_display }}</p>
          <hr>
          <h6 class="card-subtitle mb-2 text-muted">Описание:</h6>
          <p> {{ object.description }}</p>
          <hr>
          <h6 class="card-subtitle mb-2 text-muted">Компетенции:</h6>
          {% for obj in object.competences.all %}
            <p>{{ obj }}</p>
            <hr>
          {% endfor %}
          <h6 class="card-subtitle mb-2 text-muted">Результаты обучения:</h6>
          <h5 class="card-title"></h5>
          {% if object.results_edu.all %}
            <ul class="list-unstyled">
              {% for object in object.results_edu.all %}
                {% include "repository/result_edu.html"  with object=object %}
              {% endfor %}
            </ul>
          {% endif %}
          <hr>
          <h6 class="card-subtitle mb-2 text-muted">Ключевые слова:</h6>
          <p>{{ object.keywords }}</p>

        </div>
      </div>
    </div>
    <div class="col-12 col-md-6 col-lg-5 col-xl-4 p-2">
      <div class="card shadow-1">
        <div class="card-body">
          <h6 class="card-subtitle mb-2 text-muted">Владелец:</h6>
          <h5 class="card-title"> {{ object.owner }}</h5>
          <hr>
          <h6 class="card-subtitle mb-2 text-muted">Язык ресурса:</h6>
          <h5 class="card-title"> {{ object.language.title }}</h5>


        </div>
      </div>
    </div>
  </div>
  <div class="row p-2">
    <div class="col-12 col-md-6 col-lg-7 col-xl-8 p-2">
      <div class="card shadow-1 p-3">
        <h5 class="card-subtitle mb-2 text-muted">Компоненты ЭУМК:</h5>
        {#        {% if resource_components.all or platform_component.all or traditional_components.all or component_complex or literary_components.all is not None %}#}
        {% if component_complex.all %}
          <table class="table table-striped table-bordered">
            <thead>
            <tr>
              <th>Компонент</th>
              <th>Описание / Методика применения</th>
              {#              <th>Тип компонента</th>#}
            </tr>
            </thead>
            <tbody>
            {% for component in component_complex %}
              <tr>
              {#              <td>#}
              {#                <a href="{% url 'repository:repository_DigitalResource_detail' pk=component.digital_resource.pk %}">{{ component.digital_resource }}</a>#}
              {#              </td>#}
              <td>
                {% if component.polymorphic_ctype|cut:" " == "complexes|КомпонентЭОР" %}
                  <a href="{% url 'repository:repository_DigitalResource_detail' pk=component.digital_resource.pk %}">{{ component.digital_resource }}</a>
                {% elif component.polymorphic_ctype|cut:" " == "complexes|Средаобучения" %}
                  <a href="{{ component.url }}">{{ component }}</a>
                {% elif component.polymorphic_ctype|cut:" " == "complexes|Литературныйисточник" %}
                  <a href="{{ component.url }}">{{ component }}</a>
                {% else %}
                  <a href="{{ component.url }}">{{ component }}</a>
                {% endif %}
              </td>
              <td>{{ component.description }}</td>
              {#              <td>{{ component.polymorphic_ctype }}</td>#}
            {% endfor %}
            </tbody>
          </table>
        {% else %}
          Компоненты ЭУМК отсутсвуют
        {% endif %}
      </div>
      <br/>
      <div class=" card shadow-1 p-3">
        <h5 class="card-subtitle mb-2 text-muted">Структурно-тематический план: </h5>
        Структурно-тематический план отсутсвует
      </div>
      <br/>
      <div class="card shadow-1 p-3">
        <h5 class="card-subtitle mb-2 text-muted">Назначение академическим группам: </h5>
        {% if assigment_academic_group.all %}
          <table class="table table-striped table-bordered">
            <thead>
            <tr>
              <th>Академическая группа</th>
              <th>Дисциплина</th>
              <th>Учебный год</th>
            </tr>
            </thead>
            <tbody>
            {% for component in assigment_academic_group %}
              <tr>
              <td>{{ component.academic_group }}</td>
              <td>{{ component.subject }}</td>
              <td>{{ component.learn_date }}</td>
              {#                <td>{{ component.semestr }}</td>#}
            {% endfor %}
            </tbody>
          </table>
        {% else %}
          Назначенные группы отсутсвуют
        {% endif %}
      </div>
    </div>
    {% if request.user|has_owner_complex:object %}
      <div class="col-4 p-2">
        <div class="card shadow-1">
          {% if component_complex.all %}
            <a href="{% url 'complexes:complexes_ComponentComplex_list' pk=object.pk %}"
               class="btn btn-block btn-primary"><i class="pen icon"></i>Редактировать состав компонентов</a>
          {% else %}
            <a href="{% url 'complexes:complexes_ComponentComplex_list' pk=object.pk %}"
               class="btn btn-block btn-primary"><i class="fas fa-plus"></i> Добавить компоненты в ЭУМК</a>
          {% endif %}
          {% if component_complex.all %}
            <a href="{% url 'complexes:complexes_Cell_list' digital_complex_pk=object.pk %}"
               class="btn btn-block btn-primary"><i class="fas fa-plus"></i> Создать структурно-тематический план</a>
          {% else %}
            {% if assigment_academic_group.all %}
              <a href="{% url 'complexes:complexes_Cell_list' digital_complex_pk=object.pk %}"
                 class="btn btn-block btn-primary"><i class="pen icon"></i>Редактировать структурно-тематический
                план</a>
            {% endif %}
          {% endif %}
          {% if assigment_academic_group.all %}
            <a href="{% url 'complexes:complexes_AssignmentAcademicGroup_list' digital_complex_pk=object.pk %}"
               class="btn btn-block btn-primary"><i class="pen icon"></i>Изменить назначение академических
              групп</a>
          {% else %}
            <a href="{% url 'complexes:complexes_AssignmentAcademicGroup_list' digital_complex_pk=object.pk %}"
               class="btn btn-block btn-primary"><i class="pen icon"></i>Назначить академическим группам</a>
          {% endif %}
        </div>
      </div>
    {% endif %}
  </div>
{% endblock %}
